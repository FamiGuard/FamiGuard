var article={main:function(){this.eventListener();this.loadAddThis();this.loadSeal();this.star();this.leftList();this.loadVideo();this.loginStatus();this.fitIE();this.articleReply.init()},syncLoadJS:{util:{createJS:function(src,callback){var script=document.createElement('script');var head=document.getElementsByTagName('head')[0];var loaded;script.src=src;if(typeof callback==='function'){script.onload=script.onreadystatechange=function(){if(!loaded&&(!script.readyState||/loaded|complete/.test(script.readyState))){script.onload=script.onreadystatechange=null;loaded=!0;callback()}}}
head.appendChild(script)},createCss:function(src,callback){var link=document.createElement('link');var head=document.getElementsByTagName('head')[0];var loaded;link.rel="stylesheet";link.href=src;if(typeof callback=="function"){link.onload=link.onreadystatechange=function(){if(!loaded&&(!link.readyState||/loaded|complete/.test(link.readyState))){link.onload=link.onreadystatechange=null;loaded=!0;callback()}}}
head.appendChild(link)}}},eventListener:function(){$(".article-content a").click(function(){var id=$(this).attr('href').split('#')[1]
if(id){var offsectTop=$(window).width()>768?80:65;$("html,body").animate({scrollTop:($("#"+id).offset().top)-offsectTop},1)}})
$(function(){$('.close-icon').click(function(){$('.activity-footer-bg').hide()})
$('.activity-img').click(function(){})
$('.bottom-img-close').click(function(event){$('.activity-bottom-img').hide()
event.stopPropagation();event.preventDefault()})})
$(".collapse .collapse-title").click(function(){var collapseItem=$(this).parents('.collapse').eq(0);var targetContent=collapseItem.find(".callapse-content").eq(0);targetContent.slideToggle();collapseItem.toggleClass('active')})},loadedSeal:!1,loadSeal:function(){if(($(window).scrollTop()>$(".footer_box").offset().top-500)&&!this.loadedSeal){this.loadedSeal=!0;$(".footer-item1 p.seal-pay").append('<script type="text/javascript" src="https://sealserver.trustwave.com/seal.js?code=34fe4e88b0e44a50b4f0591ad8b1c41c"></script>\
            <img id="trustwaveSealImage" src="https://sealserver.trustwave.com/seal_image.php?customerId=34fe4e88b0e44a50b4f0591ad8b1c41c&amp;size=105x54&amp;style=" border="0" style="cursor:pointer;" onclick="javascript:window.open(\'https://sealserver.trustwave.com/cert.php?customerId=34fe4e88b0e44a50b4f0591ad8b1c41c&amp;size=105x54&amp;style=\', \'c_TW\', \'location=no, toolbar=no, resizable=yes, scrollbars=yes, directories=no, status=no, width=615, height=720\'); return false;" oncontextmenu="javascript:alert(\'Copying Prohibited by Law - Trusted Commerce is a Service Mark of TrustWave Holdings, Inc.\'); return false;" alt="This site is protected by Trustwave\'s Trusted Commerce program" title="This site is protected by Trustwave\'s Trusted Commerce program">')}},loadAddThis:function(){setTimeout(function(){article.syncLoadJS.util.createJS('https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c3d8c972fb4fdbd')},5000)},star:function(){$(".star-big span").mouseenter(function(){var overIndex=$(this).index()
$(".star-big span").each(function(e){if(e<=overIndex){$(".star-big span").eq(e).addClass('curr')}else{$(".star-big span").eq(e).removeClass('curr')}})})
$(".star-big span").mouseleave(function(){$(".star-big span").addClass("curr")})
var postId=$(".mask.star").attr("id")?$(".mask.star").attr("id"):'';var clickNum=commonMethods.cookie.getCookie(postId)
$(".clickNum").text(clickNum)
if(!clickNum){var thisNum=parseInt(Math.random()*200)+100;$(".clickNum").text(thisNum)}
$(".star-big span").click(function(){if(!clickNum&&$('.star-big').attr('class')=='star-big'){clickNum=parseInt(thisNum)+1;commonMethods.cookie.setCookie(postId,clickNum);$(".mask .success").show()
$(".mask .tips").hide()
$('.mask').show()
$('.star-big').addClass('Click')}else{$(".mask .tips").show()
$(".mask .success").hide()
$('.mask').show()}
$(".clickNum").text(clickNum)})
$(".mask .msg svg").click(function(){$('.mask').hide()})
var star_score=$("#star-score").text();var star_num=parseFloat(star_score);star_num=star_num<=3.5?4:star_num;var is_star_half=star_num.toString().indexOf('.')>0?!0:!1;for(var star_index=0;star_index<star_num;star_index++){if(star_index>=star_num-1&&is_star_half){$(".star.h1-desc-title span").eq(star_index).removeClass('curr')
$('.star.h1-desc-title span').eq(star_index).addClass('half')}else{$('.star.h1-desc-title span').eq(star_index).addClass('curr')}}},leftList:function(){var screenWidth=$(window).width();if(screenWidth>767){$(window).scroll(debounce(function(){var b=$(".footer").offset().top;if(b>=$(window).scrollTop()&&b<($(window).scrollTop()+$(window).height())){$('.left-list').css({"top":"auto",}).hide()}else{$('.left-list').css({"top":"300px",}).show()}},50,!0))}
$(".left-list .tabBox-top svg").click(function(){if($(".left-list").hasClass('closed')){$(".left-list").removeClass("closed").addClass("open")}else{if($(".left-list").hasClass('open')){$(".left-list").removeClass("open").addClass("closed")}else{if(screenWidth>1800){$(".left-list").addClass("closed")}else{$(".left-list").addClass("open")}}}})
$(window).resize(function(){if($(window).width()<=1570){$(".left-list").addClass("closed")}else{$(".left-list").removeClass("closed")}})
if($(window).width()<=1800){$(".left-list").addClass("closed")}else{$(".left-list").removeClass("closed")}},loadVideo:function(){$(".youtube-video").each(function(){var youtubeVideoId=$(this).attr('data-embed'),youtubeVideoThis=this,youtubeVideoStartTime=$(this).attr('starttime');youtubeVideoStartTime=youtubeVideoStartTime?youtubeVideoStartTime.length>0?"&start="+youtubeVideoStartTime:"":"";if(youtubeVideoId){var source="https://img.youtube.com/vi/"+youtubeVideoId+"/sddefault.jpg",errorSource="https://img.youtube.com/vi/"+youtubeVideoId+"/hqdefault.jpg",image=$(this).children('img').length>0?$(this).children('img')[0]:new Image(),imageStatus=!1;function loadVideoCover(){if((!image.src&&$(window).scrollTop()>$(youtubeVideoThis).offset().top-500)){image.src=source;image.addEventListener('load',function(){if(image&&image.width==120&&image.height==90&&!imageStatus){image.width=740;image.src=errorSource;imageStatus=!0}else{imageStatus=!0;$(youtubeVideoThis).append(image);$(youtubeVideoThis).append('<div class="play-button"></div>')}})}}
if(!image.src){loadVideoCover();$(window).scroll(debounce(function(){loadVideoCover()},500,!0))}
$(youtubeVideoThis).on('click','.play-button',function(){var iframe=document.createElement("iframe");iframe.setAttribute("frameborder","0");iframe.setAttribute("width","760");iframe.setAttribute("height","416");iframe.setAttribute("allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture");iframe.setAttribute("allowfullscreen","");iframe.setAttribute("src","https://www.youtube.com/embed/"+youtubeVideoId+"?rel=0&showinfo=0&autoplay=1"+youtubeVideoStartTime);$(youtubeVideoThis).html("");$(youtubeVideoThis).append(iframe)})}})},loginStatus:function(){if(commonMethods.cookie.getCookie("stoken")){$('.sign_up').each(function(){if($(this).attr(':data-url')){$(this).attr('href',$(this).attr(':data-url'))}})}},fitIE:function(){if(!isIE())return;var contentWidth=197;$(".tabNav-side a").each(function(k,v){isEllipsis($(v).text().trim(),contentWidth)&&$(v).addClass('ie')})
$(".tabNav-side a").css({"height":"51px","display":"block",})
function isIE(){return!!window.ActiveXObject||"ActiveXObject" in window}
function isEllipsis(content,contentWidth){var el=document.createElement('div')
el.innerHTML=content
el.style.whiteSpace='nowrap'
el.style.position='absolute'
el.style.opacity=0
document.body.appendChild(el)
var elWidth=el.clientWidth
document.body.removeChild(el)
return elWidth>=contentWidth*2}},articleReply:{init:function(){if(!$(".reply-area").length)return;this.replyEvent();this.loadingMore()},codeFlag:'',formId:'',formTipMes:{addressReg:/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,commentTip:"Please enter your comment here.",nameTip:"Please enter your name.",nulladdressTip:"Please enter the email.",addressTip:"Please enter a valid email address.",codeTip:"Please enter the verification code."},replyEvent:function(){var _this=this,$articleReply=$(".reply-article .article-textarea");$articleReply.bind('input propertychange',function(){if($(this).val()!==''){$('.reply-article .article-tip').hide();$(this).next().html("")}else{$('.reply-article .article-tip').show();$articleReply.next().html("Please write your comment here.")}})
$articleReply.focus(function(){$('.reply-article .article-tip').hide();var isCreateForm=$('.reply-article').find('form').hasClass('review-form');if(!isCreateForm){_this.createFormDom($(this))}});$(".reply-card").on('click','.other-reply',function(){$(this).hasClass('isFormCreated')?_this.removeFormDom($(this).attr('remove-id')):_this.createFormDom($(this))})},removeFormDom:function(currId){$("#reviewForm"+currId).remove();$("[remove-id="+currId+"]").removeClass('isFormCreated').val('').next().html('');$(".article-tip").show()},createFormDom:function($thisBtn){var _this=this;_this.formId=(Math.random()+"").replace(/\./g,"");if($thisBtn.hasClass('isFormCreated'))return;var formDomJson={comment:function(){if($thisBtn.hasClass('article-textarea'))return'';return'<div class="form-review">'+'<div class="review-box">'+'<textarea id="comment'+_this.formId+'" name="comment" class="review-textarea" placeholder="Join the discussion and share your thoughts here..." cols="30" rows="4"></textarea>'+'<label class="error"></label>'+'</div>'+'</div>'},person:function(){if(commonMethods.cookie.getCookie('reviewPersonInfo'))return'';return'<div class="form-review" id="personInfo'+_this.formId+'">'+'<div class="flex1 mr30">'+'<label for="comment_author" class="review-label"><span>*</span>Name:</label>'+'<div class="review-box">'+'<input id="comment_author'+_this.formId+'" name="comment_author" class="review-name" type="text" placeholder="Enter your name...">'+'<label class="error"></label>'+'</div>'+'</div>'+'<div class="flex1">'+'<label for="comment_email" class="review-label"><span>*</span>Email:</label>'+'<div class="review-box">'+'<input id="comment_email'+_this.formId+'" name="comment_email" class="review-email" type="email" placeholder="Enter your email...">'+'<label class="error"></label>'+'</div>'+'</div>'+'</div>'}}
var result='<form id="reviewForm'+_this.formId+'"  class="review-form " novalidate="novalidate">'+formDomJson.comment()+formDomJson.person()+'<div class="form-review">'+'<div class="flex1">'+'<label for="authcode" class="review-label"><span>*</span>Verification Code:</label>'+'<div class="review-box">'+'<div class="review-code">'+'<input maxlength="4" onkeydown="if(event.keyCode==13){event.keyCode=0;event.returnValue=false;}" id="comment_code'+_this.formId+'" class="review-captcha" name="authcode" type="text" placeholder="Enter the code...">'+'<label class="error"></label>'+'<img id="captcha_img'+_this.formId+'" class="img" src="https://apis.imyfone.com/api/captcha" alt="captcha">'+'<a id="refresh_code'+_this.formId+'" href="javascript:;">Refresh</a>'+'</div>'+'</div>'+'</div>'+'</div>'+'<input id="formSubmit'+_this.formId+'" class="base-btn base-btn-blue mr15" type="button" value="Submit">'+'<input id="formCancel'+_this.formId+'" class="base-btn base-btn-white" type="button" value="Cancel">'+'</form>'
$thisBtn.parent().parent().append(result);$thisBtn.addClass('isFormCreated').attr({"remove-id":_this.formId});if(!$("#comment"+_this.formId).length)$thisBtn.attr("id","comment"+_this.formId);_this.addFormListen()},addFormListen:function(){var _this=this;$("#formCancel"+_this.formId).off('click').on('click',function(){var currId=$(this).attr('id').replace(/[^0-9]/ig,"");_this.removeFormDom(currId)})
var input=document.querySelector("#comment_code"+this.formId);input.oninput=function(){input.value=input.value.replace(/[^\d]/g,'')}
this.bindInputListen($("#comment"+this.formId),this.formTipMes.commentTip);this.bindInputListen($("#comment_author"+this.formId),this.formTipMes.nameTip);this.bindInputListen($("#comment_email"+this.formId),this.formTipMes.addressTip,this.formTipMes.addressReg);this.bindInputListen($("#comment_code"+this.formId),this.formTipMes.codeTip);this.refreshCode();_this.formSubmit()},formSubmit:function(){var _this=this;$("#formSubmit"+_this.formId).click(function(e){e.preventDefault();var currId=$(this).attr('id').replace(/[^0-9]/ig,"");var commentValue=$("#comment"+currId).val();var authorValue=$("#comment_author"+currId).val();var emailValue=$("#comment_email"+currId).val();var codeValue=$("#comment_code"+currId).val();var replyId=$("[remove-id="+currId+"]").attr('data-id');var reviewPersonInfo=commonMethods.cookie.getCookie('reviewPersonInfo');if(reviewPersonInfo){authorValue=JSON.parse(reviewPersonInfo+'').name;emailValue=JSON.parse(reviewPersonInfo+'').email}
var formData={site_name:"famiguard_en",code:codeValue,name:authorValue,email:emailValue,content:commentValue,start:5,article_url:window.location.pathname,t:_this.codeFlag,reply_id:replyId||0}
var isValidate=_this.formValidate(currId,formData);if(!isValidate)return;var nowStime=md5Token.sitme()
$.ajax({url:base.cmsProdApiUrl()+'/api/article/reviews',type:'POST',data:formData,headers:{'token':md5Token.token(nowStime),'stime':nowStime,},dataType:'json',success:function(res){_this.refreshCode();if(res.code===1){new Dialog().reviewTip('success','You have submitted a comment successfully!');_this.removeFormDom(currId);commonMethods.cookie.setCookie('reviewPersonInfo','{"name":"'+authorValue+'", "email":"'+emailValue+'"}',7)}else{new Dialog().reviewTip('faild',res.msg)}}})})},formValidate:function(currId,formData){var _this=this;var isValidate=!0;var formItem=[{ele:'#comment'+currId,tip:_this.formTipMes.commentTip,condition:formData.content===""},{ele:'#comment_author'+currId,tip:_this.formTipMes.nameTip,condition:formData.name===""},{ele:'#comment_email'+currId,tip:_this.formTipMes.nulladdressTip,condition:formData.email===""},{ele:'#comment_email'+currId,tip:_this.formTipMes.addressTip,condition:!_this.formTipMes.addressReg.test(formData.email)},{ele:'#comment_code'+currId,tip:_this.formTipMes.codeTip,condition:formData.code===""}]
for(var i=0;i<formItem.length;i++){if(formItem[i].condition){$(formItem[i].ele).next().html(formItem[i].tip);isValidate=!1}}
return isValidate},bindInputListen:function($ele,tips,regular){$ele.bind('input propertychange',function(){var thisVal=$(this).val();var condition=regular?thisVal!==''&&regular.test(thisVal):thisVal!=='';if(condition){$(this).next().html("")}else{$ele.next().html(tips)}})},refreshCode:function(){var _this=this;setCode();$("#refresh_code"+this.formId).click(function(){setCode()})
function setCode(){_this.codeFlag=Math.random();document.getElementById('captcha_img'+_this.formId).src=base.cmsProdApiUrl()+'/api/captcha?t='+_this.codeFlag}},loadingMore:function(){var _this=this,isLoaringMore=!1;$(".reply-card").on('click','.card-choice, .more-choice',function(){if(isLoaringMore)return;isLoaringMore=!0;var $this=$(this);var dataReplyId=$(this).attr('data-reply_id')||0;var currentPage=Number($(this).attr('data-page'))+1;var isLoadingRelpy=$this.hasClass('more-choice');var nowStime=md5Token.sitme()
$.ajax({url:base.cmsProdApiUrl()+'/api/reviews/article/list?site_url='+base.domainUrl()+'&article_url='+window.location.pathname+'&reply_id='+dataReplyId+'&page='+currentPage,type:'GET',headers:{'token':md5Token.token(nowStime),'stime':nowStime,},success:function(res){isLoaringMore=!1;if(res.code===1){var data=res.data.data;if(res.data.total<=5*currentPage)$this.hide();if(!data.length)return;isLoadingRelpy?_this.fixedReplyDom(data,$this,currentPage):_this.fixedCommentDom(data,$this,currentPage)}}})})},fixedReplyDom:function(childsData,$this,currentPage){var str='',famiguard_img='';for(var j=0;j<childsData.length;j++){famiguard_img=childsData[j].full_name==='famiguard'?'famiguard':'';str+='<li class="more-item '+famiguard_img+'">'+'<p class="item-name">'+childsData[j].full_name+' <span>Reply to </span>'+childsData[j].reply_users.name+'</p>'+'<p class="item-desc">'+childsData[j].content+'</p>'+'<div class="item-other">'+'<p class="other-date">'+childsData[j].deal_add_time+'</p>'+'<p class="other-reply" data-id="'+childsData[j].id+'">Reply</p>'+'</div>'+'</li>'}
$this.attr('data-page',currentPage);$this.before(str)},fixedCommentDom:function(data,$this,currentPage){var str='';for(var i=0;i<data.length;i++){str+='<li class="card-item">'+'<h4 class="item-name">'+data[i].full_name+'</h4>'+'<p class="item-desc">'+data[i].content+'</p>'+'<div class="item-other">'+'<p class="other-date">'+data[i].deal_add_time+'</p>'+'<p class="other-reply">Reply</p>'+'</div>'+this.fixedReplyChildrenDom(data[i].childs)+'</li>'}
$this.attr('data-page',currentPage);$this.before(str)},fixedReplyChildrenDom:function(childsData){if(!childsData.length)return'';var str='<ul class="item-more">';for(var j=0;j<childsData.length;j++){str+='<li class="more-item">'+'<p class="item-name">'+childsData[j].full_name+' <span>Reply to </span>'+childsData[j].reply_users.name+'</p>'+'<p class="item-desc">'+childsData[j].content+'</p>'+'<div class="item-other">'+'<p class="other-date">'+childsData[j].deal_add_time+'</p>'+'<p class="other-reply">Reply</p>'+'</div>'+'</li>'}
str+='<div class="more-choice base-hidden">View More Comments</div></ul>'
return str},DialogFunction:function(){}},}
function Dialog(){this.$obj=$(".content-dialog");this.count=0;this.init()}
Dialog.prototype={init:function(){this.destroy()},alertDialog:function(param){var _this=this;_this.clickBtn($("#content-choice"),function(e){$("#dialog-review").hide();$("#dialog-body").show();if(_this.count){$("#dialog-body .body-mes").html(param.bodyMesContent)}
if($(e.target).hasClass('choice-no')&&!_this.count){$("#dialog-body .btn-ground").children('a.body-btn').removeClass('contact-us');$("#dialog-body .btn-ground").children('button.body-btn').addClass('cancel');$("#dialog-body .body-mes").html(param.contactMesContent)}
_this.open();_this.count++},'button')},destroy:function(){var _this=this;_this.clickBtn(_this.$obj,function(){_this.close();$("#dialog-body .btn-ground").children('a.body-btn').addClass('contact-us');$("#dialog-body .btn-ground").children('button.body-btn').removeClass('cancel')},'button')},reviewTip:function(type,mes){this.open();$("#dialog-body").hide();$("#dialog-review").show();$("#dialog-review .body-mes").html(mes);if(type==='success'){$("#dialog-review .body-icon").show().removeClass('fail-icon').addClass('success-icon')}else{$("#dialog-review .body-icon").show().removeClass('success-icon').addClass('fail-icon')}},clickBtn:function($target,fn,btnClass){var btnClass=btnClass||'',fn=fn||function(){},$target=$target||null;$target.off('click').on('click',btnClass,fn)},open:function(){this.$obj.removeClass('close').addClass("open")},close:function(){this.$obj.removeClass('open').addClass("close")}}
new Dialog().alertDialog({bodyMesContent:'You have already submitted!',contactMesContent:"Tell us your questions and leave your email address, we'll contact you as soon as possible!",})
article.main()